extends layout

block content
  .team.members#head
    h2 Mangrove Co-founders
    p.explanation Every Mangrove member is a co-founder. It means that we are all entitled to start new ventures inside our ecosystem.
    ul
      each mb,key in members
        li
          a(href="http://twitter.com/#{mb.twitter}", target="_blank")
            .member-profile(style="background-image: url(#{mb.image})")
            .member-name #{mb.first_name} #{mb.last_name}
    div(style="clear:both;")
  .team
    h2 Mangrove Friends
    p.explanation They believe in our vision. We believe in what they do.
    ul#friends

  script(type='text/javascript').
    var generateFriendDiv = function(f) {
      var html = '<li><a href="http://twitter.com/'+f.twitter+'" target="_blank">';
      html += '<div class="member-profile" style="background-image: url('+f.image+')"></div>';
      html += '<div class="member-name">'+f.first_name+' '+f.last_name+'</div></li>';

      return html;
    };

    var getNewFriend = function(friends) {
      var idx = Math.floor(Math.random() * friends.length);
      return friends[idx];
    };

    var getRandomFriends = function(amount, friends) {
      var randomFriends = [];
      for (var i = 0; i < amount; i++) {
        var idx = Math.random() * friends.length;
        randomFriends.push(friends[i]);
      }

      return randomFriends;
    };

    var initFriends = function() {
      var numFriends = 20;
      var $friendsDiv = $('#friends');
      var friends =!{JSON.stringify(friends)};
      var randomFriends = getRandomFriends(numFriends, friends);

      for (var i = 0; i < randomFriends.length; i++) {
        $friendsDiv.append(generateFriendDiv(randomFriends[i]));
      }

      window.setInterval(function() {
        var newFriend = getNewFriend(friends);
        var newFriendDiv = generateFriendDiv(newFriend);
        var idx = Math.floor(Math.random() * numFriends);

        console.log(newFriendDiv);
        $($friendsDiv.children()[idx]).replaceWith(newFriendDiv);
      }, 5000);
    };
    initFriends();
